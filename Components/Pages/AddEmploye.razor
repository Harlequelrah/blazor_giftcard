@page "/add/employee"
@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.JSInterop
@using Microsoft.AspNetCore.Authorization
@using blazor_giftcard.Services
@inject IJSRuntime JS
@rendermode InteractiveServer
@inject CustomAuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager






@code {
    private string errorMessage;
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            AuthenticationStateProvider.NotifyPostPrerender();
            try
            {
                var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
                var user = authState.User;


                if (!user.Identity.IsAuthenticated)
                {
                    NavigationManager.NavigateTo("/login", true);
                }
                StateHasChanged();
            }
            catch (Exception ex)
            {
                errorMessage = $"Erreur lors de l'initialisation du profil : {ex.Message}";
                Console.WriteLine($"Exception lors de l'initialisation du profil : {ex}");
            }
        }
}
}
